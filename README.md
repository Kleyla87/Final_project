# Служба такси

## Описание проекта

Есть таблица, состоящая из поездок такси в Нью-Йорке.  

Необходимо, используя таблицу поездок, для каждого дня рассчитать процент поездок по количеству человек в машине (без пассажиров, 1, 2,3,4 и более пассажиров). По итогу должна получиться таблица с колонками date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus. Также добавить столбцы к предыдущим результатам с самой дорогой и самой дешевой поездкой для каждой группы.

Дополнительно: провести аналитику и построить график на тему “как пройденное расстояние и количество пассажиров влияет на чаевые”.

## Технологический стек

Проект был выполнен с использованием следующих технических средств:

OS: Windows 10

Spark: 3.3.1

Scala: 2.13.10

Средство разработки: IntelliJ Idea 2022.2.3

Все расчеты производятся локально, по схеме:
загрузка данных (файл .csv) - преобразование данных - выгрузка данных (parquet)
В качестве технологического стека выбраны Apache Spark и Scala. Spark поддерживает самые различные форматы данных, используется в BigData для кластерных вычислений и крупномасштабной обработки данных. Кроме того, Spark обрабатывает данные в оперативной памяти и редко обращается к диску, поэтому работает очень быстро.

## Выполнение проекта

Перед проведением расчетов была выполнена очистка данных:
-  удалены дубликаты
- выбраны даты из требуемого интервала (с 1 по 31 января 2020года)
- удалены строки, в которых не указано количество пассажиров
- в столбце со стоимостью поездки были отрицательные значения, поэтому был применен метод abs().

Было рассчитано общее количество поездок для каждой даты и сохранено в таблице totalCount, затем последовательно рассчитаны количество поездок, максимальная и минимальная стоимость поездок для каждой даты с 0 пассажиров, с 1 пассажиром, с 2, с 3, с 4 и более, и получены соответствующие таблицы nullCount, oneCount, twoCount, threeCount и moreCount.

Итоговая таблица finalTable объединила все полученные ранее таблицы, был рассчитан процент поездок и удален лишний столбец с общим количеством поездок для каждой даты.

## Дополнительно

Выявлена некоторая зависимость между расстоянием и полученными чаевыми, но также и значительное количество выбросов, кроме того прослеживается наличие стандартных сумм чаевых, кратных 5. Корреляция между этими значения составляет 0.52

Зависимость между количеством пассажиров и суммой чаевых не прослеживается, самые большие чаевые в основном оставляет 1 пассажир, затем в среднем видно уменьшение суммы чаевых с увеличением количества пассажиров, при этом корреляция между этими значениями составляет -0.001.

## Результаты

Результаты выполнения проекта представлены в следующей структуре:

- data mart                  - Витрина данных (parquet)
- images                     - Скриншоты
- project                    - Исходный код программы
- src/main/scala             - Исходный код программы
- target                     - Исходный код программы
- README.md
- build.sbt                  - Зависимости для проекта

Если возникли вопросы или замечания по проекту, со мной можно связаться в Telegram: @Irina_Osinceva или по электронной почте kleyla@yandex.ru.



